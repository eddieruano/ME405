\hypertarget{main_8cpp}{\section{main.\-cpp File Reference}
\label{main_8cpp}\index{main.\-cpp@{main.\-cpp}}
}


This is the file for the '\hyperlink{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}{main()}' function. This function initialzies everything.  


{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$avr/io.\-h$>$}\\*
{\ttfamily \#include $<$avr/wdt.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Free\-R\-T\-O\-S.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}croutine.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rs232int.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ansi\-\_\-terminal.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}time\-\_\-stamp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}taskbase.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}textqueue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}taskqueue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}taskshare.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}shares.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-brightness.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-user.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-motor.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-encoder.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hctl\-\_\-driver.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}imu\-\_\-driver.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hctl.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-pid.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{main_8cpp_a523c5bde6173ed43b687f460b70648c1}{\#define \hyperlink{main_8cpp_a523c5bde6173ed43b687f460b70648c1}{N\-U\-L\-L\-\_\-\-M\-O\-T\-E\-R}~255}\label{main_8cpp_a523c5bde6173ed43b687f460b70648c1}

\begin{DoxyCompactList}\small\item\em Set the initital motor selector to something neutral. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}{main} (void)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
Text\-Queue $\ast$ \hyperlink{main_8cpp_acd99bf5d187d4809af2f460a5415e904}{p\-\_\-print\-\_\-ser\-\_\-queue}
\item 
Task\-Share$<$ int16\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_a68e3aef51c9bd9903eca9b72f35fee2c}{motor\-\_\-setpoint}
\item 
Task\-Share$<$ int16\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_a94ed6a23dc3685572a19c9b35ad4d91b}{motor\-\_\-power}
\item 
Task\-Share$<$ uint8\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_a044692a403a6ad19401bd615cdefd5af}{motor\-\_\-directive}
\item 
\hypertarget{main_8cpp_a23620c74793eea7c070bd9799260bef4}{Task\-Share$<$ int32\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_a23620c74793eea7c070bd9799260bef4}{encoder\-\_\-count}}\label{main_8cpp_a23620c74793eea7c070bd9799260bef4}

\begin{DoxyCompactList}\small\item\em This variable holds the encoder count and is positive or negative relative to the rotation of the counts accumulated either Clock\-Wise(+), or Counter\-Clock\-Wise (-\/) \end{DoxyCompactList}\item 
\hypertarget{main_8cpp_ab8ab0b810225c2501e1952586bb99533}{Task\-Share$<$ int16\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_ab8ab0b810225c2501e1952586bb99533}{encoder\-\_\-ticks\-\_\-per\-\_\-task}}\label{main_8cpp_ab8ab0b810225c2501e1952586bb99533}

\begin{DoxyCompactList}\small\item\em This variable holds the ticks per seconds so that other tasks like task\-\_\-user may access it. \end{DoxyCompactList}\item 
\hypertarget{main_8cpp_ada2a13ebae63bc767f0c950ff1b8cb68}{Task\-Share$<$ uint32\-\_\-t $>$ $\ast$ \hyperlink{main_8cpp_ada2a13ebae63bc767f0c950ff1b8cb68}{data\-\_\-read}}\label{main_8cpp_ada2a13ebae63bc767f0c950ff1b8cb68}

\begin{DoxyCompactList}\small\item\em for I\-M\-U data read \end{DoxyCompactList}\item 
\hypertarget{main_8cpp_a0b55a56ebac94e7852175df8a4d45d27}{Task\-Share$<$ uint8\-\_\-t $>$ $\ast$ {\bfseries activate\-\_\-encoder}}\label{main_8cpp_a0b55a56ebac94e7852175df8a4d45d27}

\item 
\hypertarget{main_8cpp_a4d52cc8ed2fe6fdc27f652a6674829b8}{Task\-Share$<$ int16\-\_\-t $>$ $\ast$ {\bfseries steering\-\_\-power}}\label{main_8cpp_a4d52cc8ed2fe6fdc27f652a6674829b8}

\item 
\hypertarget{main_8cpp_af05c4a5de56d17ffcb642c090fab6a83}{Task\-Share$<$ int16\-\_\-t $>$ $\ast$ {\bfseries x\-\_\-joystick}}\label{main_8cpp_af05c4a5de56d17ffcb642c090fab6a83}

\item 
\hypertarget{main_8cpp_aab69cf68ba3a8e2382cce86f74bd5db4}{Task\-Share$<$ int16\-\_\-t $>$ $\ast$ {\bfseries y\-\_\-joystick}}\label{main_8cpp_aab69cf68ba3a8e2382cce86f74bd5db4}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This is the file for the '\hyperlink{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}{main()}' function. This function initialzies everything. Built on top of J\-R Ridgely's architecture, this modified \hyperlink{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}{main()} function initializes two motor\-\_\-driver$\ast$ objects, an A/\-D object. and various task\-Shares and tasks. Everything is initialized here and then propogated to other classes.

\begin{DoxyAuthor}{Author}
Eddie Ruano 

J\-R Ridgely
\end{DoxyAuthor}
Revisions\-: \begin{DoxyItemize}
\item 4/21/2016 created new motor tasks and gave them the correct pointer values. \item 4/19/2016 added new shared variables \item 09-\/30-\/2012 J\-R\-R Original file was a one-\/file demonstration with two tasks \item 10-\/05-\/2012 J\-R\-R Split into multiple files, one for each task plus a main one \item 10-\/30-\/2012 J\-R\-R A hopefully somewhat stable version with global queue pointers and the new operator used for most memory allocation \item 11-\/04-\/2012 J\-R\-R Free\-R\-T\-O\-S Swoop demo program changed to a sweet test suite \item 01-\/05-\/2012 J\-R\-R Program reconfigured as M\-E405 Lab 1 starting point \item 03-\/28-\/2014 J\-R\-R Pointers to shared variables and queues changed to references \item 01-\/04-\/2015 J\-R\-R Names of share \& queue classes changed allocated with new now License\-: This file is copyright 2012 by J\-R Ridgey and released under the Lesser G\-N\-U Public License, version 2. It intended for educational use only, but its use is not limited thereto. \end{DoxyItemize}


Definition in file \hyperlink{main_8cpp_source}{main.\-cpp}.



\subsection{Function Documentation}
\hypertarget{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}{\index{main.\-cpp@{main.\-cpp}!main@{main}}
\index{main@{main}!main.cpp@{main.\-cpp}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{main_8cpp_a840291bc02cba5474a4cb46a9b9566fe}
The main function sets up the R\-T\-O\-S. Some test tasks are created. Then the scheduler is started up; the scheduler runs until power is turned off or there's a reset. \begin{DoxyReturn}{Returns}
This is a real-\/time microcontroller program which doesn't return. Ever. 
\end{DoxyReturn}


Definition at line 148 of file main.\-cpp.



References data\-\_\-read, encoder\-\_\-count, encoder\-\_\-ticks\-\_\-per\-\_\-task, motor\-\_\-directive, motor\-\_\-power, motor\-\_\-setpoint, and p\-\_\-print\-\_\-ser\-\_\-queue.



\subsection{Variable Documentation}
\hypertarget{main_8cpp_a044692a403a6ad19401bd615cdefd5af}{\index{main.\-cpp@{main.\-cpp}!motor\-\_\-directive@{motor\-\_\-directive}}
\index{motor\-\_\-directive@{motor\-\_\-directive}!main.cpp@{main.\-cpp}}
\subsubsection[{motor\-\_\-directive}]{\setlength{\rightskip}{0pt plus 5cm}Task\-Share$<$uint8\-\_\-t$>$$\ast$ motor\-\_\-directive}}\label{main_8cpp_a044692a403a6ad19401bd615cdefd5af}
This declares a taskshare which indicates that this variable is a shared variable. This variable will hold the command that the user wishes the motor to do. -\/1 Indicates C\-H\-A\-N\-G\-E\-\_\-\-D\-I\-R\-E\-C\-T\-I\-O\-N 0 Indicates S\-T\-O\-P W/ brake\-\_\-power 1 Indicates S\-E\-T P\-O\-W\-E\-R 2 Indicates F\-R\-E\-E\-W\-H\-E\-E\-L 

Definition at line 122 of file main.\-cpp.



Referenced by main().

\hypertarget{main_8cpp_a94ed6a23dc3685572a19c9b35ad4d91b}{\index{main.\-cpp@{main.\-cpp}!motor\-\_\-power@{motor\-\_\-power}}
\index{motor\-\_\-power@{motor\-\_\-power}!main.cpp@{main.\-cpp}}
\subsubsection[{motor\-\_\-power}]{\setlength{\rightskip}{0pt plus 5cm}Task\-Share$<$int16\-\_\-t$>$$\ast$ motor\-\_\-power}}\label{main_8cpp_a94ed6a23dc3685572a19c9b35ad4d91b}
This declares a taskshare which indicates that this variable is a shared variable. This variable will hold the duty cycle of a motor. 

Definition at line 114 of file main.\-cpp.



Referenced by main().

\hypertarget{main_8cpp_a68e3aef51c9bd9903eca9b72f35fee2c}{\index{main.\-cpp@{main.\-cpp}!motor\-\_\-setpoint@{motor\-\_\-setpoint}}
\index{motor\-\_\-setpoint@{motor\-\_\-setpoint}!main.cpp@{main.\-cpp}}
\subsubsection[{motor\-\_\-setpoint}]{\setlength{\rightskip}{0pt plus 5cm}Task\-Share$<$int16\-\_\-t$>$$\ast$ motor\-\_\-setpoint}}\label{main_8cpp_a68e3aef51c9bd9903eca9b72f35fee2c}
This declares a taskshare which indicates that this variable is a shared variable. This variable stores the setpoint for the P\-I\-D motor controller. 

Definition at line 110 of file main.\-cpp.



Referenced by main().

\hypertarget{main_8cpp_acd99bf5d187d4809af2f460a5415e904}{\index{main.\-cpp@{main.\-cpp}!p\-\_\-print\-\_\-ser\-\_\-queue@{p\-\_\-print\-\_\-ser\-\_\-queue}}
\index{p\-\_\-print\-\_\-ser\-\_\-queue@{p\-\_\-print\-\_\-ser\-\_\-queue}!main.cpp@{main.\-cpp}}
\subsubsection[{p\-\_\-print\-\_\-ser\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}Text\-Queue$\ast$ p\-\_\-print\-\_\-ser\-\_\-queue}}\label{main_8cpp_acd99bf5d187d4809af2f460a5415e904}
This is a print queue, descended from {\ttfamily emstream} so that things can be printed into the queue using the \char`\"{}$<$$<$\char`\"{} operator and they'll come out the other end as a stream of characters. It's used by tasks that send things to the user interface task to be printed. 

Definition at line 106 of file main.\-cpp.



Referenced by main().

