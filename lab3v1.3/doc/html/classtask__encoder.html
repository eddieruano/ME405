<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Lab 3 Integrating an Encoder with our Motor: task_encoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lab 3 Integrating an Encoder with our Motor
   &#160;<span id="projectnumber">lab3v1.3</span>
   </div>
   <div id="projectbrief">Make a driver and task that controlls an encoder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classtask__encoder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">task_encoder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>this is the declaration for '<a class="el" href="classtask__encoder.html" title="this is the declaration for &#39;task_encoder&#39; which directly handles the encoder_driver. Only three variables are required for this class since the ISR is declared in the driver. ">task_encoder</a>' which directly handles the <a class="el" href="classencoder__driver.html" title="This class will enable an interruputs on pins given by the main() function. ">encoder_driver</a>. Only three variables are required for this class since the ISR is declared in the driver.  
 <a href="classtask__encoder.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="task__encoder_8h_source.html">task_encoder.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for task_encoder:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classtask__encoder.png" usemap="#task_encoder_map" alt=""/>
  <map id="task_encoder_map" name="task_encoder_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae099e34c1fdea7272e4adc5b85372869"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__encoder.html#ae099e34c1fdea7272e4adc5b85372869">task_encoder</a> (const char *, unsigned portBASE_TYPE, size_t, emstream *, <a class="el" href="classencoder__driver.html">encoder_driver</a> *)</td></tr>
<tr class="memdesc:ae099e34c1fdea7272e4adc5b85372869"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the constructor prototype, added the pointer for an <a class="el" href="classencoder__driver.html" title="This class will enable an interruputs on pins given by the main() function. ">encoder_driver</a> to be passed in by main.  <a href="#ae099e34c1fdea7272e4adc5b85372869">More...</a><br/></td></tr>
<tr class="separator:ae099e34c1fdea7272e4adc5b85372869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8380b1f111bf5d6b4256f16e355c0afc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__encoder.html#a8380b1f111bf5d6b4256f16e355c0afc">run</a> (void)</td></tr>
<tr class="memdesc:a8380b1f111bf5d6b4256f16e355c0afc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is called by the RTOS once to run the task loop for ever and ever.  <a href="#a8380b1f111bf5d6b4256f16e355c0afc">More...</a><br/></td></tr>
<tr class="separator:a8380b1f111bf5d6b4256f16e355c0afc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a93ba34cbfaf270161b396f276d7772d7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93ba34cbfaf270161b396f276d7772d7"></a>
<a class="el" href="classencoder__driver.html">encoder_driver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__encoder.html#a93ba34cbfaf270161b396f276d7772d7">p_encoder</a></td></tr>
<tr class="memdesc:a93ba34cbfaf270161b396f276d7772d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the declaration for the local copy of the <a class="el" href="classencoder__driver.html" title="This class will enable an interruputs on pins given by the main() function. ">encoder_driver</a> pointer. <br/></td></tr>
<tr class="separator:a93ba34cbfaf270161b396f276d7772d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a00db1124d04019b3d945f4081310cb92"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00db1124d04019b3d945f4081310cb92"></a>
int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__encoder.html#a00db1124d04019b3d945f4081310cb92">last_count</a></td></tr>
<tr class="memdesc:a00db1124d04019b3d945f4081310cb92"><td class="mdescLeft">&#160;</td><td class="mdescRight">This variable hold the previous count of encoder ticks since the last time the task was called. <br/></td></tr>
<tr class="separator:a00db1124d04019b3d945f4081310cb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7938fe7c5ea145f553400ad53a2985"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2a7938fe7c5ea145f553400ad53a2985"></a>
int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__encoder.html#a2a7938fe7c5ea145f553400ad53a2985">count_diff</a></td></tr>
<tr class="memdesc:a2a7938fe7c5ea145f553400ad53a2985"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the diffrence between the global count and the local count. <br/></td></tr>
<tr class="separator:a2a7938fe7c5ea145f553400ad53a2985"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>this is the declaration for '<a class="el" href="classtask__encoder.html" title="this is the declaration for &#39;task_encoder&#39; which directly handles the encoder_driver. Only three variables are required for this class since the ISR is declared in the driver. ">task_encoder</a>' which directly handles the <a class="el" href="classencoder__driver.html" title="This class will enable an interruputs on pins given by the main() function. ">encoder_driver</a>. Only three variables are required for this class since the ISR is declared in the driver. </p>

<p>Definition at line <a class="el" href="task__encoder_8h_source.html#l00076">76</a> of file <a class="el" href="task__encoder_8h_source.html">task_encoder.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae099e34c1fdea7272e4adc5b85372869"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">task_encoder::task_encoder </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>a_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned portBASE_TYPE&#160;</td>
          <td class="paramname"><em>a_priority</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>a_stack_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">emstream *&#160;</td>
          <td class="paramname"><em>p_ser_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classencoder__driver.html">encoder_driver</a> *&#160;</td>
          <td class="paramname"><em>p_encoder_inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the constructor prototype, added the pointer for an <a class="el" href="classencoder__driver.html" title="This class will enable an interruputs on pins given by the main() function. ">encoder_driver</a> to be passed in by main. </p>
<p>This is the constructor for the <a class="el" href="classtask__encoder.html" title="this is the declaration for &#39;task_encoder&#39; which directly handles the encoder_driver. Only three variables are required for this class since the ISR is declared in the driver. ">task_encoder</a> class.</p>
<p>It initialzes all the variables given to the TaskBase super class and then initializes the encoder pointer given and the last_count variable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a_name</td><td>TA character string which will be the name of this task. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_priority</td><td>The priority at which this task will initially run (default: 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_stack_size</td><td>The size of this task's stack in bytes (default: configMINIMAL_STACK_SIZE) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_ser_dev</td><td>Pointer to a serial device (port, radio, SD card, etc.) which can be used by this task to communicate (default: NULL) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_encoder_inc</td><td>This holds the pointer to the encoder given to this task by the main menu. </td></tr>
  </table>
  </dd>
</dl>
<p>Initialize pointer passed from <a class="el" href="main_8cpp.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a> to local variable to work with </p>

<p>Definition at line <a class="el" href="task__encoder_8cpp_source.html#l00077">77</a> of file <a class="el" href="task__encoder_8cpp_source.html">task_encoder.cpp</a>.</p>

<p>References <a class="el" href="main_8cpp_source.html#l00123">encoder_count</a>, <a class="el" href="task__encoder_8h_source.html#l00082">last_count</a>, and <a class="el" href="task__encoder_8h_source.html#l00094">p_encoder</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8380b1f111bf5d6b4256f16e355c0afc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_encoder::run </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method is called by the RTOS once to run the task loop for ever and ever. </p>
<p>This method is called once by the RTOS scheduler.</p>
<p>Each time that this method is run it initializes a tickcount and loops in an infinite for(;;) loop that compares the last tick count stored locally with the most current reading of encoder count which lies in the global TaskShare variable 'encoder_count'. It then waits 10 ms to run again and since it has the highest priority we know that it will certainly run every 10ms. This means if we multiply the difference in encoder counts (local vs. global) and use the constant time difference we can obtain an estimate of the counts per sec. </p>

<p>Definition at line <a class="el" href="task__encoder_8cpp_source.html#l00105">105</a> of file <a class="el" href="task__encoder_8cpp_source.html">task_encoder.cpp</a>.</p>

<p>References <a class="el" href="main_8cpp_source.html#l00125">count_per_sec</a>, <a class="el" href="main_8cpp_source.html#l00123">encoder_count</a>, and <a class="el" href="task__encoder_8h_source.html#l00082">last_count</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="task__encoder_8h_source.html">task_encoder.h</a></li>
<li><a class="el" href="task__encoder_8cpp_source.html">task_encoder.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 28 2016 11:43:00 for Lab 3 Integrating an Encoder with our Motor by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
